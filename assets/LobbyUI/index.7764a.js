window.__require=function t(e,o,i){function n(a,s){if(!o[a]){if(!e[a]){var c=a.split("/");if(c=c[c.length-1],!e[c]){var p="function"==typeof __require&&__require;if(!s&&p)return p(c,!0);if(r)return r(c,!0);throw new Error("Cannot find module '"+a+"'")}a=c}var u=o[a]={exports:{}};e[a][0].call(u.exports,function(t){return n(e[a][1][t]||t)},u,u.exports,t,e,o,i)}return o[a].exports}for(var r="function"==typeof __require&&__require,a=0;a<i.length;a++)n(i[a]);return n}({ChooseLevelUI:[function(t,e,o){"use strict";cc._RF.push(e,"5c5621S2uZBy5v/B3HCjZ1I","ChooseLevelUI");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,i){var n,r=arguments.length,a=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(r<3?n(a):r>3?n(e,o,a):n(e,o))||a);return r>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../Script/Common/yyComponent"),s=t("../../Script/Common/PlayerData"),c=t("../../Script/GameSpecial/GameEventType"),p=t("../../Script/Common/Action3dManager"),u=t("../../Script/GameSpecial/GlobalEnum"),l=cc._decorator,h=l.ccclass,y=l.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.plane=null,e.itemLayer=null,e.levelItemSprites=[],e.passItem=null,e.clockItem=null,e.levelLayer=null,e.levelLabels=[],e.countPerPage=16,e.curPage=0,e.maxPage=62,e.btnPrePage=null,e.btnNextPage=null,e.unlockEffectMask=null,e.unlockGuang=null,e}return n(e,t),e.prototype.init=function(){this.initUnlockEffect(),this.initComponents(),this.initItems(),this.initPage()},e.prototype.reset=function(){this.resetUnlockEffect()},e.prototype.show=function(){this.node.active=!0;var t=s.default.getData("gameData.curLevel");this.curPage=void 0===t?0:Math.floor((t-1)/this.countPerPage),this.showRecords(this.curPage),this.updateBtnState(),this.playPlane()},e.prototype.playPlane=function(){var t=0,e=this.plane.getComponent(cc.Widget);e&&(t=e.bottom,e.enabled=!1);var o,i=this.plane.height*this.plane.anchorY;o=e?-this.node.height*this.node.anchorY+t+i:this.node.height*(1-this.node.anchorY)-this.plane.height*(1-this.plane.anchorY),this.plane.setPosition(0,i+this.node.height*(1-this.node.anchorY),0);var n=p.default.moveTo(1,0,o,0);n.easing(p.default.easeElasticOut(.35)),p.default.getMng(p.ActionMngType.UI).runAction(this.plane,n)},e.prototype.initItems=function(){var t=this;this.countPerPage=this.itemLayer.childrenCount,this.levelItemSprites=[];for(var e=function(e){o.itemLayer.children[e].on("touchend",function(){t.onChooseLevel(e)},o),o.levelItemSprites.push(o.itemLayer.children[e].getComponent(cc.Sprite))},o=this,i=0;i<this.countPerPage;++i)e(i);for(this.levelLabels=[],i=0;i<this.countPerPage;++i)this.levelLabels.push(this.levelLayer.children[i].getComponent(cc.Label))},e.prototype.onChooseLevel=function(t){this.emit(c.EventType.AudioEvent.playClickBtn);var e=this.curPage*this.countPerPage+t+1;e<=s.default.getData("gameData.curLevel")&&this.emit(c.EventType.DirectorEvent.enterChosedLevel,e)},e.prototype.initPage=function(){var t=this.itemLayer.childrenCount;this.maxPage=Math.floor(1e3/t)},e.prototype.showRecords=function(t){void 0===t&&(t=this.curPage);for(var e=s.default.getData("gameData.curLevel"),o=t*this.countPerPage+1,i=0;i<this.countPerPage;++i){var n=o+i;n>e?(this.levelItemSprites[i].spriteFrame=this.clockItem,this.levelLabels[i].string=""):(this.levelItemSprites[i].spriteFrame=this.passItem,this.levelLabels[i].string=n.toString())}},e.prototype.updateBtnState=function(){this.btnPrePage.interactable=this.curPage>0,this.btnNextPage.interactable=this.curPage<this.maxPage},e.prototype.onBtnPrePage=function(){this.emit(c.EventType.AudioEvent.playClickBtn),this.curPage<=0||(this.curPage-=1,this.showRecords(this.curPage),this.updateBtnState())},e.prototype.onBtnNextPage=function(){this.emit(c.EventType.AudioEvent.playClickBtn),this.curPage>=this.maxPage||(this.curPage+=1,this.showRecords(this.curPage),this.updateBtnState())},e.prototype.onBtnClose=function(){this.emit(c.EventType.AudioEvent.playClickBtn),this.emit(c.EventType.UIEvent.exit,u.GlobalEnum.UI.chooseLevel)},e.prototype.onBtnUnclock=function(){this.emit(c.EventType.AudioEvent.playClickBtn),this.emit(c.EventType.SDKEvent.showVideo,{success:this.unlockLevel.bind(this)})},e.prototype.unlockLevel=function(){var t=this.curPage,e=s.default.getData("gameData.curLevel");(t=void 0===e?0:Math.floor(e/this.countPerPage))!=this.curPage&&(this.curPage=t,this.showRecords(this.curPage));var o=e%this.countPerPage,i=this.plane.convertToNodeSpaceAR(this.itemLayer.children[o].convertToWorldSpaceAR(cc.v2(0,38)));this.showUnlockEffect(i)},e.prototype.initUnlockEffect=function(){this.unlockEffectMask.active=!1,this.unlockGuang.active=!1},e.prototype.resetUnlockEffect=function(){p.default.getMng(p.ActionMngType.UI).stopAllActions(this.unlockEffectMask),p.default.getMng(p.ActionMngType.UI).stopAllActions(this.unlockGuang),this.unlockEffectMask.active=!1,this.unlockGuang.active=!1},e.prototype.showUnlockEffect=function(t){if(this.emit(c.EventType.UIEvent.showTouchMask),void 0===t){var e=s.default.getData("gameData.curLevel")%this.countPerPage;t=this.plane.convertToNodeSpaceAR(this.itemLayer.children[e].convertToWorldSpaceAR(cc.v2(0,38)))}this.unlockEffectMask.active=!0,this.unlockEffectMask.setPosition(t),this.unlockEffectMask.opacity=50;var o=p.default.fadeTo(1,255);o.easing(p.default.easeSinIn());var i=p.default.callFun(this.onUnlockEffectFadeIn.bind(this),this),n=p.default.delay(.3),r=p.default.fadeTo(.5,0),a=p.default.callFun(this.onUnlockEffectFadeOut,this),u=p.default.sequence(o,i,n,r,a);p.default.getMng(p.ActionMngType.UI).runAction(this.unlockEffectMask,u)},e.prototype.onUnlockEffectFadeIn=function(){this.emit(c.EventType.PlayerDataEvent.updatePlayerData,{type:"gameData",attribute:"gameData.curLevel",value:1,mode:"+"}),this.showRecords(this.curPage),this.updateBtnState()},e.prototype.onUnlockEffectFadeOut=function(){p.default.getMng(p.ActionMngType.UI).stopAllActions(this.unlockGuang),this.unlockEffectMask.active=!1,this.unlockGuang.active=!1,this.emit(c.EventType.UIEvent.hideTouchMask)},r([y(cc.Node)],e.prototype,"plane",void 0),r([y(cc.Node)],e.prototype,"itemLayer",void 0),r([y(cc.SpriteFrame)],e.prototype,"passItem",void 0),r([y(cc.SpriteFrame)],e.prototype,"clockItem",void 0),r([y(cc.Node)],e.prototype,"levelLayer",void 0),r([y(cc.Button)],e.prototype,"btnPrePage",void 0),r([y(cc.Button)],e.prototype,"btnNextPage",void 0),r([y(cc.Node)],e.prototype,"unlockEffectMask",void 0),r([y(cc.Node)],e.prototype,"unlockGuang",void 0),r([h],e)}(a.default);o.default=d,cc._RF.pop()},{"../../Script/Common/Action3dManager":void 0,"../../Script/Common/PlayerData":void 0,"../../Script/Common/yyComponent":void 0,"../../Script/GameSpecial/GameEventType":void 0,"../../Script/GameSpecial/GlobalEnum":void 0}],ConfigSettingUI:[function(t,e,o){"use strict";cc._RF.push(e,"5219a61WZBHrLPY3aPlPMyY","ConfigSettingUI");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,i){var n,r=arguments.length,a=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(r<3?n(a):r>3?n(e,o,a):n(e,o))||a);return r>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../Script/Common/yyComponent"),s=t("../../Script/GameSpecial/GameConfig"),c=t("../../Script/GameSpecial/GameEventType"),p=t("../../Script/GameSpecial/GlobalEnum"),u=cc._decorator,l=u.ccclass,h=u.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.togBGM=null,e.togEffect=null,e.togVibrate=null,e}return n(e,t),e.prototype.initConfig=function(){var t=s.default.audioConfig;this.togBGM.isChecked=t.bgm,this.togEffect.isChecked=t.effect;var e=s.default.driveConfig;this.togVibrate.isChecked=e.vibrate},e.prototype.init=function(){this.initComponents(),this.initConfig()},e.prototype.show=function(){this.node.active||(this.node.active=!0,this.emit(c.EventType.DirectorEvent.pauseLevel),this.initConfig())},e.prototype.hide=function(){this.node.active&&(this.node.active=!1,this.emit(c.EventType.DirectorEvent.resumeLevel))},e.prototype.saveConfig=function(){var t={bgm:this.togBGM.isChecked,effect:this.togEffect.isChecked};s.default.audioConfig=t;var e={vibrate:this.togVibrate.isChecked};s.default.driveConfig=e},e.prototype.onBtnClose=function(){this.saveConfig(),this.emit(c.EventType.DirectorEvent.resumeLevel),this.emit(c.EventType.UIEvent.exit,p.GlobalEnum.UI.configSetting)},e.prototype.onCloseBGM=function(){this.togBGM.isChecked?this.emit(c.EventType.AudioEvent.playBGM,p.GlobalEnum.AudioClip.BGM):this.emit(c.EventType.AudioEvent.stopBGM)},r([h(cc.Toggle)],e.prototype,"togBGM",void 0),r([h(cc.Toggle)],e.prototype,"togEffect",void 0),r([h(cc.Toggle)],e.prototype,"togVibrate",void 0),r([l],e)}(a.default);o.default=y,cc._RF.pop()},{"../../Script/Common/yyComponent":void 0,"../../Script/GameSpecial/GameConfig":void 0,"../../Script/GameSpecial/GameEventType":void 0,"../../Script/GameSpecial/GlobalEnum":void 0}],ShopItem:[function(t,e,o){"use strict";cc._RF.push(e,"5a631MrW1ZFcYMlXrLofj5W","ShopItem");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,i){var n,r=arguments.length,a=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(r<3?n(a):r>3?n(e,o,a):n(e,o))||a);return r>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a,s=t("../../Script/Common/yyComponent"),c=t("../../Script/Common/Loader"),p=t("../../Script/GameSpecial/GameEventType"),u=t("../../Script/Common/PlayerData"),l=t("../../Script/Common/GameData"),h=t("../../Script/GameSpecial/GlobalEnum"),y=cc._decorator,d=y.ccclass,f=y.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.itemSprite=null,e.LockMask=null,e._unclock=!1,e.btnImg=null,e.priceLabel=null,e.imgUsing=null,e.imgUnlock=null,e.imgNeedBuy=null,e.imgNeedTry=null,e.imgTrying=null,e.itemState=null,e}return n(e,t),Object.defineProperty(e.prototype,"unlock",{get:function(){return this._unclock},set:function(t){this._unclock=!!t,this.LockMask.active=!this._unclock,this.setImg(this.data.id,this._unclock)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"itemId",{get:function(){return this.data?this.data.id:null},enumerable:!1,configurable:!0}),e.prototype.setItemData=function(t){this.setData(t)},e.prototype.updateState=function(){this.setBtnState()},e.prototype.setData=function(t){var e=u.default.getData("gameData.PlayerSkin"),o=e.try==t||e.owned.indexOf(t)>=0;this.data={id:t,unlock:o},this.unlock=o,this.setBtnState()},e.prototype.setImg=function(t,e){var o=this,i=t+"_";i+=e?"1":"2",c.default.loadBundleRes("LobbyUI","Image/roleSelect",function(t){o.itemSprite.spriteFrame=t.getSpriteFrame(i)},cc.SpriteAtlas,!1)},e.prototype.setBtnState=function(){var t=l.default.getData(h.GlobalEnum.GoodsType.playerSkin,this.itemId),e=u.default.getCurSkinId(h.GlobalEnum.GoodsType.playerSkin),o=u.default.getData("gameData.PlayerSkin").owned;switch(this.itemId==e?this.itemState=a.using:o.indexOf(this.itemId)>=0?this.itemState=a.unlock:t.video?this.itemState=a.needTry:this.itemState=a.needBuy,this.priceLabel.node.active=!1,this.itemState){case a.needBuy:this.unlock=!1,this.btnImg.spriteFrame=this.imgNeedBuy,this.priceLabel.node.active=!0,this.priceLabel.string=t.price.toString();break;case a.needTry:this.unlock=!1,this.btnImg.spriteFrame=this.imgNeedTry;break;case a.using:this.unlock=!0,this.btnImg.spriteFrame=this.imgUsing;break;case a.unlock:this.unlock=!0,this.btnImg.spriteFrame=this.imgUnlock}},e.prototype.onBtnBuy=function(){switch(this.emit(p.EventType.AudioEvent.playClickBtn),this.itemState){case a.using:break;case a.unlock:this.chooseUse();break;case a.needBuy:this.chooseBuy();break;case a.needTry:this.chooseTry();break;case a.trying:}},e.prototype.chooseUse=function(){this.emit(p.EventType.ShopEvent.onBtnUse,this)},e.prototype.chooseBuy=function(){this.emit(p.EventType.ShopEvent.onBtnBuy,this)},e.prototype.chooseTry=function(){this.emit(p.EventType.ShopEvent.onBtnTry,this)},r([f(cc.Sprite)],e.prototype,"itemSprite",void 0),r([f(cc.Node)],e.prototype,"LockMask",void 0),r([f(cc.Sprite)],e.prototype,"btnImg",void 0),r([f(cc.Label)],e.prototype,"priceLabel",void 0),r([f(cc.SpriteFrame)],e.prototype,"imgUsing",void 0),r([f(cc.SpriteFrame)],e.prototype,"imgUnlock",void 0),r([f(cc.SpriteFrame)],e.prototype,"imgNeedBuy",void 0),r([f(cc.SpriteFrame)],e.prototype,"imgNeedTry",void 0),r([f(cc.SpriteFrame)],e.prototype,"imgTrying",void 0),r([d],e)}(s.default);o.default=m,function(t){t[t.using=0]="using",t[t.unlock=1]="unlock",t[t.needBuy=2]="needBuy",t[t.needTry=3]="needTry",t[t.trying=4]="trying"}(a||(a={})),cc._RF.pop()},{"../../Script/Common/GameData":void 0,"../../Script/Common/Loader":void 0,"../../Script/Common/PlayerData":void 0,"../../Script/Common/yyComponent":void 0,"../../Script/GameSpecial/GameEventType":void 0,"../../Script/GameSpecial/GlobalEnum":void 0}],ShopUI:[function(t,e,o){"use strict";cc._RF.push(e,"f1146XD9dZL0oi7dzvFICfT","ShopUI");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,i){var n,r=arguments.length,a=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(r<3?n(a):r>3?n(e,o,a):n(e,o))||a);return r>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../Script/Common/yyComponent"),s=t("../../Script/GameSpecial/GlobalEnum"),c=t("../../Script/GameSpecial/GameEventType"),p=t("../../Script/Common/GameData"),u=t("../../Script/Common/PlayerData"),l=t("./ShopItem"),h=cc._decorator,y=h.ccclass,d=h.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._uiType=s.GlobalEnum.UI.shop,e.itemLayer=null,e.itemPrefab=null,e.items=[],e}return n(e,t),Object.defineProperty(e.prototype,"uiType",{get:function(){return this._uiType},enumerable:!1,configurable:!0}),e.prototype.init=function(){this.initItem(),this.initComponents(),this.onEvents()},e.prototype.onEvents=function(){this.on(c.EventType.ShopEvent.onBtnBuy,this.onBtnBuy,this),this.on(c.EventType.ShopEvent.onBtnTry,this.onBtnVideo,this),this.on(c.EventType.ShopEvent.onBtnUse,this.onBtnChoose,this)},e.prototype.reset=function(){this.resetItem()},e.prototype.show=function(){this.node.active=!0,this.reset(),this.setData()},e.prototype.setData=function(){this.updateBtns()},e.prototype.hide=function(){this.reset(),this.node.active=!1},e.prototype.initItem=function(){this.curItemId=null,this.items=[],this.itemLayer.removeAllChildren();for(var t=1;t<=6;++t){var e=cc.instantiate(this.itemPrefab),o=e.getComponent(l.default);o.init(t),this.itemLayer.addChild(e),this.items.push(o)}},e.prototype.resetItem=function(){},e.prototype.updateBtns=function(){for(var t=this.items.length-1;t>=0;--t)this.items[t].updateState()},e.prototype.onBtnExit=function(){this.emit(c.EventType.AudioEvent.playClickBtn),this.emit(c.EventType.UIEvent.exit,this.uiType),this.emit(c.EventType.ShopEvent.exitShop)},e.prototype.onBtnBuy=function(t){this.curItemId=t.itemId,this.emit(c.EventType.AudioEvent.playClickBtn);var e=u.default.getData("gameData.asset.gold"),o=p.default.getData(s.GlobalEnum.GoodsType.playerSkin,this.curItemId);e<o.price?this.tipGoldUnenough():(this.subGold(o.price),this.unlockSkin(s.GlobalEnum.GoodsType.playerSkin,this.curItemId),this.setCurSkin(s.GlobalEnum.GoodsType.playerSkin,this.curItemId),this.updateBtns(),this.playChooseEffect())},e.prototype.subGold=function(t){this.emit(c.EventType.PlayerDataEvent.updatePlayerData,{type:"gameData",attribute:"gameData.asset.gold",value:t,mode:"-",save:!1,emit:!0})},e.prototype.unlockSkin=function(t,e){this.emit(c.EventType.PlayerDataEvent.updatePlayerData,{type:"gameData",attribute:"gameData."+t+".owned",value:parseInt(e),mode:"push",save:!1,emit:!1})},e.prototype.setCurSkin=function(t,e){this.emit(c.EventType.PlayerDataEvent.updatePlayerData,{type:"gameData",attribute:"gameData."+t+".cur",value:parseInt(e),mode:"=",save:!0,emit:!0})},e.prototype.tipGoldUnenough=function(){this.emit(c.EventType.UIEvent.showTip,"\u91d1\u5e01\u4e0d\u8db3")},e.prototype.onBtnVideo=function(t){this.curItemId=t.itemId,this.emit(c.EventType.AudioEvent.playClickBtn),this.emit(c.EventType.SDKEvent.showVideo,{success:this.tryByVideo.bind(this),quit:this.tryByVideoQuit.bind(this)})},e.prototype.tryByVideo=function(){this.unlockSkin(s.GlobalEnum.GoodsType.playerSkin,this.curItemId),this.setCurSkin(s.GlobalEnum.GoodsType.playerSkin,this.curItemId),this.updateBtns(),this.playChooseEffect()},e.prototype.tryByVideoQuit=function(){this.emit(c.EventType.UIEvent.showTip,"\u89c2\u770b\u5b8c\u6574\u89c6\u9891\u624d\u80fd\u8bd5\u7528\u65b0\u76ae\u80a4\u54e6~~")},e.prototype.onBtnChoose=function(t){this.emit(c.EventType.AudioEvent.playClickBtn),this.curItemId=t.itemId;var e=t.itemId;u.default.getData("gameData.PlayerSkin.owned").indexOf(e)>=0?(this.emit(c.EventType.PlayerDataEvent.trySkinEnd,s.GlobalEnum.GoodsType.playerSkin),this.emit(c.EventType.PlayerDataEvent.updatePlayerData,{type:"gameData",attribute:"gameData.PlayerSkin.cur",value:e,mode:"=",save:!0,emit:!0})):this.emit(c.EventType.PlayerDataEvent.updatePlayerData,{type:"gameData",attribute:"gameData.PlayerSkin.try",value:e,mode:"=",save:!0,emit:!0}),this.updateBtns(),this.playChooseEffect()},e.prototype.playChooseEffect=function(){this.emit(c.EventType.AudioEvent.playEffect,s.GlobalEnum.AudioClip.selectRole)},r([d(cc.Node)],e.prototype,"itemLayer",void 0),r([d(cc.Prefab)],e.prototype,"itemPrefab",void 0),r([y],e)}(a.default);o.default=f,cc._RF.pop()},{"../../Script/Common/GameData":void 0,"../../Script/Common/PlayerData":void 0,"../../Script/Common/yyComponent":void 0,"../../Script/GameSpecial/GameEventType":void 0,"../../Script/GameSpecial/GlobalEnum":void 0,"./ShopItem":"ShopItem"}],TouchBannerUI:[function(t,e,o){"use strict";cc._RF.push(e,"6746aKOT7lHLZEiPuMTWQ+O","TouchBannerUI");var i,n=this&&this.__extends||(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,i){var n,r=arguments.length,a=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(n=t[s])&&(a=(r<3?n(a):r>3?n(e,o,a):n(e,o))||a);return r>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../Script/Common/Action3dManager"),s=t("../../Script/Common/yyComponent"),c=t("../../Script/GameSpecial/AdConfig"),p=t("../../Script/GameSpecial/GameEventType"),u=t("../../Script/GameSpecial/GlobalEnum"),l=cc._decorator,h=l.ccclass,y=l.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.zadanbidiankaiguan=null,e.bar=null,e.barTotalLength=0,e.progress=0,e.recoverTimer=0,e.box=null,e.yaoshui=null,e.boxPlaying=!1,e.touchCount=0,e.targetProgress=0,e}return n(e,t),Object.defineProperty(e.prototype,"uiType",{get:function(){return u.GlobalEnum.UI.touchBanner},enumerable:!1,configurable:!0}),e.prototype.init=function(t){this.initAnim(),this.initProgress(),this.randomTouchCount(t)},e.prototype.reset=function(){this.resetAnim(),this.resetProgress()},e.prototype.show=function(t){console.log("\u5f00\u5173\u914d\u7f6e\uff1a",t),this.node.active=!0,this.reset(),this.randomTouchCount(t),this.zadanbidiankaiguan=t.config[u.GlobalEnum.RecommendFlowConfig.zadanbidiankaiguan]},e.prototype.hide=function(){this.off(p.EventType.SDKEvent.show,this.onShow,this),this.reset(),this.node.active=!1},e.prototype.initProgress=function(){this.barTotalLength=this.bar.getComponent(cc.Sprite).spriteFrame.getOriginalSize().width,this.progress=0,this.updateBarWidth()},e.prototype.resetProgress=function(){this.progress=0,this.updateBarWidth()},e.prototype.updateBarWidth=function(){var t=this.barTotalLength*this.progress;t<1&&(t=1),this.bar.width=t},e.prototype.updateProgress=function(t){this.progress>.7?this.subProgress(1.5*t):this.progress>.4?this.subProgress(1.2*t):this.subProgress(1*t)},e.prototype.subProgress=function(t){this.progress-=t,this.progress<0&&(this.progress=0),this.updateBarWidth()},e.prototype.addProgress=function(t){this.progress+=t,this.progress>1&&(this.progress=1),this.updateBarWidth(),this.progress>=1&&(this.emit(p.EventType.UIEvent.touchBannerFinish),this.emit(p.EventType.UIEvent.exit,this.uiType))},e.prototype.initAnim=function(){this.boxPlaying=!1},e.prototype.resetAnim=function(){a.default.getMng(a.ActionMngType.UI).stopAllActions(this.box),this.box.angle=0,this.boxPlaying=!1},e.prototype.playAnim=function(){this.box.angle=0,this.shakeBox()},e.prototype.shakeBox=function(){if(!this.boxPlaying){this.boxPlaying=!0;var t=a.default.rotateTo2d(.05,10),e=a.default.rotateTo2d(.05,0),o=a.default.rotateTo2d(.05,-10),i=a.default.rotateTo2d(.05,0),n=a.default.callFun(this.onBoxAnimFinish,this),r=a.default.sequence(t,e,o,i,n);a.default.getMng(a.ActionMngType.UI).runAction(this.box,r)}},e.prototype.onBoxAnimFinish=function(){this.boxPlaying=!1},e.prototype.randomTouchCount=function(t){var e=2,o=6;if(void 0!==t&&void 0!==t.config){var i=t.config[u.GlobalEnum.RecommendFlowConfig.touchBannerClickCount].split("-");e=parseInt(i[0]),o=parseInt(i[1])}this.touchCount=e+Math.floor(Math.random()*(o-e+.999)),this.targetProgress=.1*this.touchCount,console.log("targetProgress:",this.targetProgress)},e.prototype.onBtnShot=function(){if(this.playAnim(),this.recoverTimer=.2,this.addProgress(.3),this.progress>=this.targetProgress){console.log("\u663e\u793abanner,",this.progress),this.emit(p.EventType.SDKEvent.showBanner,{id:c.AdConfig.bannerID.gameScene,style:{horizontal:"middle"}});var t=this.zadanbidiankaiguan;console.log(t),t&&1==t?(this.waitTouchBanner(),console.log("\u8fd8\u6ca1\u7ed3\u675f\uff0c\u5f97\u70b9\u51fbbanner\u624d\u53ef\u4ee5")):(this.autoHideBanner(),console.log("\u597d\u4e86\u7ee7\u7eed\u6e38\u620f\u5427"))}},e.prototype.autoHideBanner=function(){var t=this;setTimeout(function(){t.emit(p.EventType.SDKEvent.hideBanner),t.emit(p.EventType.UIEvent.touchBannerFinish)},1e3)},e.prototype.waitTouchBanner=function(){var t=this;this.once(p.EventType.SDKEvent.show,this.onShow,this),setTimeout(function(){t.emit(p.EventType.SDKEvent.hideBanner)},1e3)},e.prototype.onShow=function(){console.log("\u91cd\u65b0\u56de\u5230\u6e38\u620f\uff0c\u8282\u70b9\u663e\u793a\uff1a",this.node.activeInHierarchy),this.node.activeInHierarchy&&(this.emit(p.EventType.SDKEvent.hideBanner,c.AdConfig.bannerID.gameScene),this.emit(p.EventType.UIEvent.touchBannerFinish))},e.prototype.update=function(t){this.updateProgress(t)},r([y(cc.Node)],e.prototype,"bar",void 0),r([y(cc.Node)],e.prototype,"box",void 0),r([y(cc.Prefab)],e.prototype,"yaoshui",void 0),r([h],e)}(s.default);o.default=d,cc._RF.pop()},{"../../Script/Common/Action3dManager":void 0,"../../Script/Common/yyComponent":void 0,"../../Script/GameSpecial/AdConfig":void 0,"../../Script/GameSpecial/GameEventType":void 0,"../../Script/GameSpecial/GlobalEnum":void 0}]},{},["ChooseLevelUI","ConfigSettingUI","ShopItem","ShopUI","TouchBannerUI"]);